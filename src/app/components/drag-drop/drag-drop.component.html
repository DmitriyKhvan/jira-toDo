<!-- <div mat-dialog-content>
  <mat-form-field class="w-100">
    <mat-label><h3 style="color: red">New Column</h3></mat-label>
    <input matInput [(ngModel)]="newColumnText" />
  </mat-form-field>
</div> -->

<div class="container-fluid MainEl" (click)="enableAddCartPanel()">
  <div cdkDropListGroup class="drag-row">
    <!-- d-flex -->
    <div
      class="d-flex"
      *ngFor="let column of boardService.getBoard$() | async; let idx = index"
    >
      <div class="drag-column bgColorItems heightControl">
        <div class="splitBROP">
          <div class="borderItems2" (click)="prevDef($event)">
            <input
              *ngIf="!column.title; else title"
              type="text"
              name="columnTitle"
              #focus
              class="columnTitleBorder"
              (change)="setTitle($event, column.id)"
              (click)="prevDef($event)"
            />
            <div
              class="btnRowItems"
              *ngIf="!column.title"
              (click)="prevDef($event)"
            >
              <button
                class="itemsBtnItems"
                (click)="setTitle($event, column.id)"
              >
                <span class="aui-icon aui-iconfont-check iconsItemsSize"></span>
              </button>
              <button class="itemsBtnItems" (click)="onDeleteColumn(column.id)">
                <span class="aui-icon aui-iconfont-cross iconsItemsSize"></span>
              </button>
            </div>
          </div>

          <ng-template #title>
            <p
              class="dropTitleText"
              (click)="upDateColTitleSow($event)"
              *ngIf="updateColumnTitle"
            >
              {{ column.title }} {{ column.list.length }} задачи
            </p>

            <div
              class="borderItems2"
              (click)="prevDef($event)"
              *ngIf="!updateColumnTitle"
            >
              <input
                type="text"
                name="columnTitle"
                value="{{ column.title }}"
                #focus
                class="columnTitleBorder"
                (change)="
                  updateText(column.title, column.id, column.list, $event)
                "
                (click)="prevDef($event)"
              />
              <div
                class="btnRowItems"
                *ngIf="!updateColumnTitle"
                (click)="prevDef($event)"
              >
                <button
                  class="itemsBtnItems"
                  (click)="
                    updateText(column.title, column.id, column.list, $event)
                  "
                >
                  <span
                    class="aui-icon aui-iconfont-check iconsItemsSize"
                  ></span>
                </button>
                <button
                  class="itemsBtnItems"
                  (click)="onDeleteColumn(column.id)"
                >
                  <span
                    class="aui-icon aui-iconfont-cross iconsItemsSize"
                  ></span>
                </button>
              </div>
            </div>
          </ng-template>

          <div class="aui-buttons" *ngIf="column.title">
            <button
              class="aui-button aui-dropdown2-trigger aui-button-split-more aui-button-primaryItem"
              [attr.aria-controls]="'split-container-dropdown' + idx"
            >
              Split more
            </button>
          </div>
          <!-- modal +++++++++++++++++++++++++++++++++++++++++++-->
          <div
            *ngIf="
              boardService.modaleIdDeleteColumn == column.id &&
              !openDialogForDelete
            "
            class="modalDelete"
          >
            <section
              id="static-dialog"
              class="aui-dialog2 aui-dialog2-medium"
              role="dialog"
              tabindex="-1"
              aria-labelledby="static-dialog--heading"
            >
              <!-- Dialog header -->
              <header class="aui-dialog2-header">
                <!-- The dialog's title -->
                <h1 class="aui-dialog2-header-main" id="static-dialog--heading">
                  The modal dialog title
                </h1>
                <!-- Actions to render on the right of the header -->
                <div class="aui-dialog2-header-secondary">
                  <form class="aui" action="#">
                    <input
                      id="demo-search"
                      class="text"
                      type="search"
                      name="search"
                    />
                  </form>
                </div>
                <!-- Close icon -->
                <button
                  class="aui-close-button"
                  type="button"
                  aria-label="close"
                ></button>
              </header>
              <!-- Main dialog content -->
              <div class="aui-dialog2-content">
                <p>Content for the modal dialog.</p>
              </div>
              <!-- Dialog footer -->
              <footer class="aui-dialog2-footer">
                <!-- Actions to render on the right of the footer -->
                <div class="aui-dialog2-footer-actions">
                  <button
                    class="aui-button aui-button-primary"
                    (click)="onDeleteColumn(column.id)"
                  >
                    Удалить
                  </button>

                  <button
                    class="aui-button aui-button-link"
                    (click)="closeModalDelete()"
                  >
                    Отменить
                  </button>
                </div>
              </footer>
            </section>
          </div>
          <!-- modal +++++++++++++++++++++++++++++++++++++++++++++ -->

          <aui-dropdown-menu [id]="'split-container-dropdown' + idx">
            {{ column.id }}
            <aui-item-link (click)="openDeleteModal(column.id)"
              >delete column</aui-item-link
            >
            <aui-item-link>Menu item 2</aui-item-link>
            <aui-item-link>Menu item 3</aui-item-link>
          </aui-dropdown-menu>
        </div>

        <div
          cdkDropList
          [cdkDropListData]="column.list"
          class="example-list"
          (cdkDropListDropped)="drop($event)"
        >
          <mat-card
            *ngFor="let item of column.list; let idx2 = index"
            cdkDrag
            class="todyBody example-box"
          >
            <!-- modal +++++++++++++++++++++++++++++++++++++++++++-->
            <div
              *ngIf="
                boardService.modaleIdAddFlag == column.id &&
                !openModalAddFlags &&
                boardService.modaleIdAddFlag == item.id
              "
              class="modalDelete"
            >
              <section
                id="static-dialog"
                class="aui-dialog2 aui-dialog2-medium"
                role="dialog"
                tabindex="-1"
                aria-labelledby="static-dialog--heading"
              >
                <!-- Dialog header -->
                <header class="aui-dialog2-header">
                  <!-- The dialog's title -->
                  <h2
                    class="aui-dialog2-header-main"
                    id="static-dialog--heading"
                  >
                    Добавить метки к ключу MSB-33
                  </h2>
                  <!-- Actions to render on the right of the header -->

                  <!-- Close icon -->
                </header>
                <!-- Main dialog content -->
                <div class="aui-dialog2-content">
                  <p>Начните набирать для поиска и создания меток</p>
                  <input type="text" [(ngModel)]="selectedFild" />
                  <!-- <form class="aui">
                 <select
                   id="select2-example"
                   multiple
                   [(ngModel)]="selectedFild"
                 >
                   <option value="CONF">Confluence</option>
                   <option value="JIRA">JIRA</option>
                   <option value="BAM">Bamboo</option>
                   <option value="JAG">JIRA Agile</option>
                   <option value="CAP">JIRA Capture</option>
                   <option value="AUI">AUI</option>
                   <option value="{{ selectedFild }}">
                     {{ selectedFild }}
                   </option>
                 </select>
               </form> -->
                  {{ selectedFild }}
                </div>
                <!-- Dialog footer -->
                <footer class="aui-dialog2-footer">
                  <!-- Actions to render on the right of the footer -->
                  <div class="aui-dialog2-footer-actions">
                    <button
                      class="aui-button aui-button-primary"
                      (click)="onAddFilterFlug(column.id, item.id, idx, idx2)"
                    >
                      Готово
                    </button>

                    <button
                      class="aui-button aui-button-link"
                      (click)="closeModalAddFlag()"
                    >
                      Отменить
                    </button>
                  </div>
                  <div class="aui-dialog2-footer-hint">
                    Выбрать несколько карточек с CTRL + клик
                  </div>
                </footer>
              </section>

              <!-- <section
             id="demo-dialog"
             class="aui-dialog2 aui-dialog2-small aui-layer"
             role="dialog"
             tabindex="-1"
             aria-labelledby="dialog-show-button--heading"
             hidden
           >
             <header class="aui-dialog2-header">
               <h2 class="aui-dialog2-header-main" id="static-dialog--heading">
                 Добавить метки к ключу MSB-33
               </h2>
             </header>
             <div class="aui-dialog2-content">
               <p>Начните набирать для поиска и создания меток</p>
               <input type="text" [(ngModel)]="selectedFild" />
             </div>
             <footer class="aui-dialog2-footer">
               <div class="aui-dialog2-footer-actions d-flex">
                 <div class="d-flex">
                   <button
                     class="aui-button aui-button-primary"
                     (click)="onAddFilterFlug(column.id, item.id)"
                   >
                     Готово
                   </button>

                   <button
                     class="aui-button aui-button-link"
                     (click)="closeModalAddFlag()"
                   >
                     Отменить
                   </button>
                 </div>

                 <div class="aui-dialog2-footer-hint">
                   Выбрать несколько карточек с CTRL + клик
                 </div>
               </div>
             </footer>
           </section> -->
            </div>
            <!-- modal +++++++++++++++++++++++++++++++++++++++++++++ -->
            <mat-card-header>
              <mat-card-title class="drotTextItems">
                <div class="d-flex justify-content-between">
                  <div class="">
                    <mat-card-title class="drotText">{{
                      item.text
                    }}</mat-card-title>
                    <div
                      *ngFor="let itemFlag of item.filterFluf"
                      class="itemFlags"
                    >
                      <span class="filterFlugsItem">
                        {{ itemFlag.name }}
                      </span>
                    </div>
                  </div>
                  <div class="dropMenu">
                    <input
                      class="inputMenu"
                      [id]="'check' + idx + idx2"
                      type="checkbox"
                      name="menu"
                    />
                    <label class="lebelMenu" [attr.for]="'check' + idx + idx2">
                      <span class="aui-icon aui-icon-small aui-iconfont-more"
                        >Insert meaningful text here for accessibility</span
                      >
                    </label>
                    <ul class="submenu">
                      <li (click)="onCardDelete(item.id, column.id)">
                        <a href="#">Удалить</a>
                      </li>
                      <li>
                        <a
                          *ngIf="!item.flag"
                          href="#"
                          (click)="onAddFlag(item.id, column.id)"
                          >Добавить флажек</a
                        >
                        <a
                          *ngIf="item.flag"
                          href="#"
                          (click)="onDeleteFlag(item.id, column.id)"
                          >Снять отметку</a
                        >
                      </li>
                      <li
                        id="dialog-show-button"
                        (click)="onModallAddFlug(column.id, item.id, idx, idx2)"
                      >
                        <a href="#">Добавить метку</a>
                      </li>
                      <p style="color: #000">ПЕРЕМЕСТИТЬ В</p>

                      <li (click)="onAddToEnd(idx, idx2)">
                        <a href="#">Нижняя часть столбца</a>
                      </li>
                    </ul>
                  </div>
                </div>
              </mat-card-title>

              <mat-card-subtitle class="bbg">
                <div class="rowItem">
                  <div class="rowItem1">
                    <div class="checkbox">
                      <span
                        class="aui-icon aui-icon-small aui-iconfont-checkbox colorChe"
                        >Insert meaningful text here for accessibility</span
                      >
                      <label for="checkBoxOne " class="colorTextMs"
                        >MSB-8</label
                      >
                    </div>
                  </div>

                  <div class="d-flex">
                    <span
                      *ngIf="item.flag"
                      class="aui-icon aui-icon-small aui-iconfont-flag"
                      style="color: red"
                      >Insert meaningful text here for accessibility</span
                    >
                    <img
                      src="../../../assets/images/jpg.svg"
                      alt="Person McRealface"
                      class="aui-avatar-imageRadius"
                    />
                  </div>
                </div>
              </mat-card-subtitle>
            </mat-card-header>
          </mat-card>

          <!-- -- -->
          <div
            *ngIf="boardService.modaleId !== column.id && idx === 0"
            class="flexItem1 columnAddEndItem"
            (click)="onAddCard(column.id, $event)"
          >
            <button class="btnIcons">
              <span
                class="aui-icon aui-icon-small aui-iconfont-add iconColorsPlus"
                >Insert meaningful text here for accessibility</span
              >
            </button>
            <p class="pTextIcons">Create notes</p>
          </div>
          <!-- ------- -->
          <div
            *ngIf="boardService.modaleId !== column.id && idx !== 0"
            class="flexItem2 columnAddEndItem"
            (click)="onAddCard(column.id, $event)"
          >
            <button class="btnIcons2">
              <span
                class="aui-icon aui-icon-small aui-iconfont-add iconColorsPlus"
                >Insert meaningful text here for accessibility</span
              >
            </button>
            <p class="pTextIcons">Create notes</p>
          </div>

          <div
            *ngIf="boardService.modaleId === column.id"
            (click)="stPr($event)"
            class="styleBorder"
          >
            <textarea
              class="textarea textareaItemStyle"
              name="comment"
              id="textarea-id"
              placeholder="Что нужно сделать?"
              [(ngModel)]="newCartText"
            ></textarea>
            <button (click)="onAddCards(column.id, $event)">
              Создать задачу
            </button>
          </div>
        </div>
      </div>
      <!-- <div (click)="addColumn(column.id)">
        <button class="addColumns">
          <span class="aui-icon aui-icon-large aui-iconfont-add fwss"></span>
        </button>
      </div> -->
      <!-- ---- -->
    </div>
    <!-- -- -->
    <!-- <div class="flexItem1">
      <button class="btnIcons">
        <span class="aui-icon aui-icon-small aui-iconfont-add iconColorsPlus"
          >Insert meaningful text here for accessibility</span
        >
      </button>
      <p class="pTextIcons">Create notes</p>
    </div>
    <div class="flexItem2" (click)="onAddCard(column.id)">
      <button class="btnIcons2">
        <span class="aui-icon aui-icon-small aui-iconfont-add iconColorsPlus"
          >Insert meaningful text here for accessibility</span
        >
      </button>
      <p class="pTextIcons">Create notes</p>
    </div> -->
    <!-- ---- -->
    <div (click)="addColumn($event)" *ngIf="canAddItem">
      <button class="addColumns">
        <span class="aui-icon aui-icon-large aui-iconfont-add fwss"></span>
      </button>
    </div>
    <!--  -->
  </div>
</div>
